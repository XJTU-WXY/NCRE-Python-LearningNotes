# 数据库设计基础
### 基本概念
#### 构成
- **数据库系统DBS**：
  - **数据库DB**： 长期存储的有组织可共享的数据集合（**集成、共享**）
  - **数据库管理系统DBMS**：数据库系统的核心
  - 数据库管理员
  - 硬件平台
  - 软件平台
#### 数据管理发展的三个阶段
- 人工管理阶段：无共享，冗余度大，数据无结构
- 文件系统阶段：共享性差，冗余度大，记录内有结构（整体无结构）
- 数据库系统阶段：共享性大，冗余度小，高度的物理独立性，一定的逻辑独立性，整体结构化，用数据模型描述
#### 数据库管理的特点
- 集成性：实现了整体数据的结构化
- 高共享性、低冗余性
- 独立性：数据与程序互不依赖
- 统一管理与控制
#### 数据库系统的体系结构
- 三级模式
  - 外模式/子模式/用户模式：用户的数据视图，可有**任意多个**
  - 概念模式：全局数据**逻辑结构**的描述
  - 内模式/物理模式：物理结构与存储方式的描述
- 两级映射
  - 外模式->概念模式
  - 概念模式->内模式
### 数据模型
#### 三要素:
- 数据结构
- 数据操作
- 数据约束
#### 类型:
- 概念数据模型/概念模型:
  - **E-R模型/实体联系模型:**
    - 实体（矩形）:客观存在的具体单位
    - 联系（菱形）:实体间的关系
      - 一对一
      - 一对多
      - 多对多
    - 属性（椭圆形）:实体的特性
- 逻辑数据模型/数据模型
  - 层次模型：树形结构，自顶向下
  - 网状模型：网络结构，一个结点可以没有或有多个父节点
  - 关系模型（最常用）：
    - 构成：
      - 关系：二维表（TABLE）的名字
      - 属性：二维表的一列
      - 值域：属性值的取值范围
      - 元组：二维表的一行
      - 键：可用作一个元组的唯一标识值的属性集
        - 候选键
        - 主键：在二维表的若干个候选键中指定一个为主键
        - 外键：表1的一个属性为表2的键，则其为表1的外键
    - 完整性约束：
      - 实体完整性约束（最基本）：主键属性值不为空
      - 参照完整性约束：不能引用不存在的元组
      - 用户定义的完整性约束
- 物理数据模型/物理模型
### 关系代数
#### 基本运算符
- 集合运算符
  - $∪$：并
  - $∩$：交
  - $-$：差
  - $×$：笛卡尔积（逐个配对，列相加，行相乘）
- 专门的关系运算符：
  - $σ$：选择（按条件取行为一个新表（即关系））
  - $π$：投影（按条件取列为一个新表（即关系））
  - $⋈$：连接
    - 自然连接（$R⋈S$）：对两个关系中共有的列（属性）的属性值相同的行进行连接
    - 等值连接（$R⋈_{i=j}S$）：对两个关系中非共有的列（一个是i和一个是j）的属性值相同的行进行连接
  - $÷$：除（笛卡尔积的逆运算）：
    1. 先从R中选出属性值与S全等的行
    2. 再从R中去掉所有与S共有的列
### 数据库设计与管理
#### 数据库设计的4阶段
- 需求分析
- 概念设计：E-R模型
- 逻辑设计：关系模型
  - 转换规则
  - 规范化理论
- 物理设计
#### 转换规则：将E-R模型转换为关系模型
|E-R模型|关系模型|
|-------|-------|
|实体|元组|
|属性|属性|
|联系|关系|
|实体集|关系|
#### 规范化理论：克服逻辑结构中的插入异常、删除异常、数据冗余等问题
- **第一范式（1NF）：** 二维表中的每一列的属性都不可再分
- **第二范式（2NF）：** 在满足第一范式的基础之上，实体属性完全依赖于主键，如果某个属性仅依赖主键中的部分列，则应该独立出来
- **第三范式（3NF）：** 在满足第二范式的基础之上，消除属性对主键的传递依赖